<%# app/views/hyrax/file_sets/media_display/_video.html.erb %>
<div class="viewer-wrapper">
    <video id="video" controls class="video-js vjs-default-skin vjs-fill" style="width:100%;height:100%" preload="auto">
        <% get_derivative_list(file_set).each_with_index do |derivative, index| %>
            <source src="<%= s3_url(derivative) %>" type="video/mp4" label="<%= get_derivative_res(index) %>" />
        <% end %>
        <%= t('hyrax.file_set.show.downloadable_content.video_tag_not_supported') %>
    </video>
    <script>
        // null out the amd configuration hash before including video.js
        define._oldAmd = define.amd
        define.amd = null
    </script>
    <script src="https://vjs.zencdn.net/8.10.0/video.min.js"></script>
    <script src="https://unpkg.com/@silvermine/videojs-quality-selector/dist/js/silvermine-videojs-quality-selector.min.js"></script>
    <script>
        videojs('video', {}, function () {
            var player = this;
            player.controlBar.addChild('QualitySelector');
        });
    </script>
    <script>
        // maybe unnecessary (?) but restore the bundle's define.amd value
        define.amd = define._oldAmd
    </script>
</div>
